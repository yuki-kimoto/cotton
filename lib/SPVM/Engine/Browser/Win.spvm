class Engine::Browser::Win {
  use Engine::App;
  use Eg::Node;
  use List;
  
  use Engine::Runtime::Engine::Win;
  use Engine::Runtime;

  use Engine::Runtime::Windows::API;
  
  static method rgb : Eg::Style::Color ($red : float, $green : float, $blue : float) {
    my $color = Eg::Style::Color->new($red, $green, $blue, 1);
    return $color;
  }
  
  static method main : int ($start_file : string, $args : string[]) {
    my $app = Engine::App->new;
    
    # Application name
    $app->set_name("コットン");
    
    # Add index page
    {
      my $text1 = Eg->text("あああああ");
      $text1->set_color(&rgb(0x00, 0x00, 0xFF));
      $text1->set_background_color(&rgb(0x00, 0x33, 0x44));
      
      my $div1 = Eg->div_({style => {
        "color" => "#0x0000FF",
        "background-color" => "#0x003344"
      }}, [$text1]);
      
      $div1->set_color(&rgb(0x00, 0x00, 0xFF));
      $div1->set_background_color(&rgb(0x00, 0x33, 0x44));
      
      my $text2 = Eg->text("いいいいい");
      $text2->set_color(&rgb(0x00, 0x00, 0xFF));
      $text2->set_background_color(&rgb(0x00, 0x33, 0x44));
      
      my $div2 = Eg->div_({style => {
        "color" => "#0x0000FF",
        "background-color" => "#0x003344"
      }}, [$text2]);
      
      $div2->set_color(&rgb(0x00, 0x00, 0xFF));
      $div2->set_background_color(&rgb(0x00, 0x33, 0x44));
      
      my $body = Eg->body([
        $div1,
        $div2
      ]);
      $body->set_color(&rgb(0x00, 0x00, 0xFF));
      $body->set_background_color(&rgb(0x00, 0x33, 0x44));
      
      # Set current page;
      $app->set_index_document($body);
    }
    
    # Create runtime
    my $runtime = Engine::Runtime->new({});
    
    # Create engine
    my $engine = Engine::Runtime::Engine::Win->new({});
    
    # API
    my $cotton_api_win = Engine::Runtime::Windows::API->new;
    $cotton_api_win->set_engine($engine);
    $runtime->set_api($cotton_api_win);


    # Execute application
    $runtime->set_app($app);
    
    $engine->set_runtime($runtime);
    $engine->set_app($app);
    
    $engine->create_main_window;
    
    $engine->run;

  }
}
